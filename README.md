This is working code I tested against IOS-XE images (csr1000v images specifically) on the Cisco Modeling Labs 2.8 platform. Far from revolutionary work, I'm short on time and didn't even bother to modularize a bunch of these yet, but they work and can serve as a jumping-off-point down the road when I have more time for such things. 

Effervescently,
Mihk